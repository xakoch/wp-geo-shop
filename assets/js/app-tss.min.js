document.addEventListener("DOMContentLoaded",function(){("undefined"!=typeof barba?initPageTransitions:(console.warn("Barba.js не найден"),initScript))()});let lenis;function initLenis(){try{var e;"undefined"==typeof Lenis?console.warn("Lenis не найден"):(lenis&&lenis.destroy(),lenis=new Lenis({duration:1.2,easing:e=>Math.min(1,1.001-Math.pow(2,-10*e)),direction:"vertical",gestureDirection:"vertical",smooth:!0,mouseMultiplier:1,smoothTouch:!1,touchMultiplier:2,infinite:!1}),requestAnimationFrame(function e(t){lenis.raf(t),requestAnimationFrame(e)}),0<(e=document.querySelectorAll('a[href^="#"]:not([href="#"])')).length&&e.forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();e=this.getAttribute("href"),e=document.querySelector(e);e&&lenis.scrollTo(e,{offset:0,duration:1.2,easing:e=>Math.min(1,1.001-Math.pow(2,-10*e))})})}),console.log("Lenis initialized successfully"))}catch(e){console.error("Error in initLenis:",e)}}function initPageTransitions(){try{barba.hooks.before(()=>{window.scrollTo({top:0})}),barba.hooks.after(()=>{initAnimNumbers();var e=document.querySelectorAll(".slider-block"),e=(0<e.length&&initSliderBlocks(e),document.querySelectorAll(".typecard__tab")),t=document.querySelectorAll(".typecard__content");0<e.length&&0<t.length&&initTypecardTabs(e,t)}),barba.init({sync:!1,debug:!1,timeout:7e3,transitions:[{name:"default",once({next:e}){updateBodyClass(e.html),initScript(),"undefined"!=typeof gsap&&gsap.from(e.container,{opacity:0,duration:.5,ease:"power1.out",clearProps:"all"})},async leave(e){try{if(e&&e.current&&e.current.container){if(initBarbaNavUpdate(e),"undefined"!=typeof gsap)return gsap.to(e.current.container,{opacity:0,duration:.5,ease:"power1.out",onComplete:()=>{e.current.container.remove()}});e.current.container.style.opacity="0",await delay(500),e.current.container.remove()}}catch(e){console.error("Error in leave transition:",e)}},async enter({next:t}){try{var e,o,n;if(updateBodyClass(t.html),t.container.style.opacity="0","undefined"!=typeof gsap)return(e=gsap.timeline()).to(t.container,{opacity:1,duration:.5,ease:"power1.out",clearProps:"opacity"}),o=t.container.querySelector(".header"),n=t.container.querySelector(".hero__title h1"),o&&e.to(o,{opacity:1,y:0,duration:.8,ease:"power2.out"},"-=0.3"),n&&e.to(n,{opacity:1,y:0,duration:.8,ease:"power2.out"},"-=0.5"),e;t.container.style.opacity="1"}catch(e){console.error("Error in enter transition:",e),t.container.style.opacity="1"}},async beforeEnter({next:e}){updateBodyClass(e.html),"undefined"!=typeof gsap&&(o=e.container.querySelector(".header"),t=e.container.querySelector(".hero__title h1"),o&&gsap.set(o,{opacity:0,y:-30}),t)&&gsap.set(t,{opacity:0,y:50});var t,o="div.wpcf7 > form";0<$(e.container).find(o).length&&$(o).each(function(){var e=$(this);wpcf7.init(e[0])}),initScript()}}]})}catch(e){console.error("Error in initPageTransitions:",e),initScript()}}function updateBodyClass(e){try{var t;e&&(t=e.match(/<body.+?class="([^"]*)"/i),document.body.setAttribute("class",t?t[1]:""))}catch(e){console.error("Error in updateBodyClass:",e)}}function delay(t=2e3){return new Promise(e=>setTimeout(e,t))}function initBarbaNavUpdate(e){try{if(e&&e.next&&e.next.html){const t=$(e.next.html).find("[data-barba-update]");0<t.length&&$("[data-barba-update]").each(function(e){0<$(t[e]).length&&(e=$(t[e]).attr("data-link-status"),$(this).attr("data-link-status",e))})}}catch(e){console.error("Error in initBarbaNavUpdate:",e)}}function initWindowInnerheight(){try{$(document).ready(()=>{var e=.01*window.innerHeight;document.documentElement.style.setProperty("--vh",e+"px")})}catch(e){console.error("Error in initWindowInnerheight:",e)}}function initScript(){try{initLenis(),initBarbaNavUpdate(),initWindowInnerheight(),initSwiperSlider(),initBtnMenuOpenClose(),animateCommonElements(),setTimeout(()=>{initDynamicVideoModal()},100);var e=document.querySelectorAll(".slider-block"),t=(0<e.length&&initSliderBlocks(e),document.querySelectorAll(".typecard__tab")),o=document.querySelectorAll(".typecard__content");0<t.length&&0<o.length&&initTypecardTabs(t,o),isHomePage()&&initHomePage(),initModals(),initCalc(),initMultiStepForm(),initAnimNumbers(),initZohoForms(),document.querySelector(".login-page")&&(initLoginPage(),togglePasswordVisibility()),document.addEventListener("wpcf7mailsent",function(e){setTimeout(function(){var e=document.querySelector(".wpcf7-response-output");e&&jQuery(e).fadeOut()},3e3)})}catch(e){console.error("Error in initScript:",e)}}function initDynamicVideoModal(){document.getElementById("dynamic-video-modal")||((e=document.createElement("div")).innerHTML=`
            <div class="modal modal__reviews" id="dynamic-video-modal">
                <div class="modal__content">
                    <button class="modal__close" data-modal-close>✕</button>
                    <div class="video-container">
                        <div class="video-placeholder">
                            <div class="loader">Загрузка...</div>
                        </div>
                    </div>
                </div>
                <div class="modal__overlay"></div>
            </div>
        `,document.body.appendChild(e.firstElementChild));const a=document.getElementById("dynamic-video-modal"),r=a.querySelector(".video-container"),i=r.querySelector(".video-placeholder");var e=a.querySelector("[data-modal-close]"),t=a.querySelector(".modal__overlay");let s=null;function l(){var e,t;return window.YT?Promise.resolve():((e=document.createElement("script")).src="https://www.youtube.com/iframe_api",(t=document.getElementsByTagName("script")[0]).parentNode.insertBefore(e,t),new Promise(e=>{window.onYouTubeIframeAPIReady=function(){e()}}))}function o(){if(s){try{s.stopVideo(),s.destroy()}catch(e){console.warn("Ошибка при удалении плеера",e)}s=null}a.classList.remove("is-active"),window.lenis&&"function"==typeof window.lenis.start&&window.lenis.start()}l(),document.querySelectorAll("[data-modal-open^='modal-reviews-']").forEach(n=>{n.addEventListener("click",e=>{e.preventDefault();e=function(e){if(e.hasAttribute("data-video-id"))return e.getAttribute("data-video-id");if(e=e.getAttribute("data-modal-open")){e=document.getElementById(e);if(e){var e=e.querySelector("iframe");if(e&&e.getAttribute("src"))return(e=(e=e.getAttribute("src"))&&e.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/))&&11===e[2].length?e[2]:null}}return null}(n);if(e){{var t=e;e=r.querySelector("div:not(.video-placeholder)");e&&e.remove(),i.style.display="flex";const o=document.createElement("div");o.id="youtube-player-"+Date.now(),r.appendChild(o),l().then(()=>{s=new YT.Player(o.id,{videoId:t,playerVars:{autoplay:1,modestbranding:1,rel:0,showinfo:0,controls:1},events:{onReady:function(e){i.style.display="none"},onError:function(e){console.error("Ошибка загрузки видео "+t),i.innerHTML="Ошибка загрузки видео"}}})}).catch(e=>{console.error("Ошибка при загрузке YouTube API",e),i.innerHTML="Ошибка загрузки YouTube API"})}a.classList.add("is-active"),window.lenis&&"function"==typeof window.lenis.stop&&window.lenis.stop()}else console.error("ID видео не найден")})}),e.addEventListener("click",e=>{e.preventDefault(),o()}),t.addEventListener("click",e=>{e.preventDefault(),o()}),document.addEventListener("keydown",e=>{"Escape"===e.key&&a.classList.contains("is-active")&&o()})}function initModals(){const n=new Lenis({autoRaf:!0,prevent:e=>e.classList.contains("modal")});window.lenis=n;var e=document.querySelectorAll("[data-modal-open]:not([data-modal-open^='modal-reviews-'])"),t=document.querySelectorAll("[data-modal-close]"),o=document.querySelectorAll(".modal:not(#dynamic-video-modal)");e.forEach(o=>{o.addEventListener("click",e=>{e.preventDefault();var e=o.getAttribute("data-modal-open"),t=document.getElementById(e);t&&(t.classList.add("is-active"),console.log(`Modal ${e} opened`),n.stop())})}),t.forEach(t=>{t.addEventListener("click",e=>{e.preventDefault();e=t.closest(".modal");e&&(e.classList.remove("is-active"),console.log(`Modal ${e.id} closed`),document.querySelector(".modal.is-active")||n.start())})}),o.forEach(t=>{t.addEventListener("click",e=>{e.target===t&&(t.classList.remove("is-active"),console.log(`Modal ${t.id} closed by outside click`),document.querySelector(".modal.is-active")||n.start())})})}function initBtnMenuOpenClose(){const t=document.querySelector("body"),o=document.querySelector(".burger"),n=document.querySelectorAll(".mobile__menu");var e=document.querySelectorAll(".mobile__menu .header__nav a"),a=document.querySelectorAll(".language-chooser a");gsap.set(n,{scale:.95,autoAlpha:0,rotation:-2,transformOrigin:"top right",filter:"blur(15px)"}),o.addEventListener("click",e=>{e.preventDefault(),o.classList.contains("is-active")?(o.classList.remove("is-active"),t.classList.remove("overflow"),gsap.timeline({defaults:{ease:"power2.inOut",duration:.3}}).to(n,{scale:.95,rotation:-2,filter:"blur(15px)",duration:.3,force3D:!0}).to(n,{autoAlpha:0,duration:.3},"-=0.2")):(o.classList.add("is-active"),t.classList.add("overflow"),gsap.timeline({defaults:{ease:"power2.out",duration:.3}}).to(n,{autoAlpha:1,duration:.3}).to(n,{scale:1,rotation:0,duration:.3,clearProps:"rotation"},"-=0.2").to(n,{filter:"blur(0px)",duration:.3},"-=0.4"))}),e.forEach(e=>{e.addEventListener("click",e=>{e.preventDefault(),o.classList.remove("is-open"),t.classList.remove("overflow"),gsap.to(n,{autoAlpha:0,ease:"power2"})})}),a.forEach(e=>{e.addEventListener("click",e=>{e.preventDefault(),o.classList.remove("is-open"),t.classList.remove("overflow"),gsap.to(n,{autoAlpha:0,ease:"power2"})})})}function animateCommonElements(){try{if("undefined"==typeof gsap)console.warn("GSAP не найден, анимации элементов недоступны");else{var e=document.querySelector(".header"),t=(e&&gsap.fromTo(e,{y:-30},{y:0,duration:.8,ease:"power2.out"}),document.querySelector(".hero__title h1"));t&&gsap.fromTo(t,{opacity:0,y:50},{opacity:1,y:0,duration:.8,delay:.2,ease:"power2.out"});const o=document.querySelector(".footer");if(o){gsap.set(o,{y:80});const n=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&!o.classList.contains("animated")&&(gsap.to(o,{y:0,duration:.8,ease:"power2.out"}),o.classList.add("animated"),n.unobserve(o))})},{threshold:.1,rootMargin:"0px 0px -10% 0px"});n.observe(o)}}}catch(e){console.error("Error in animateCommonElements:",e)}}function isHomePage(){try{var e;return document.body.classList.contains("home")||document.body.classList.contains("homepage")||document.body.classList.contains("home-page")?!0:!("/"!==(e=window.location.pathname)&&"/index.html"!==e&&"/index.php"!==e&&!e.endsWith("/")&&""!==e)}catch(e){return console.error("Error in isHomePage:",e),!1}}function initSliderBlocks(e){e.forEach(i=>{try{const l=i.querySelector(".slider-track"),c=i.querySelectorAll(".slider-slide");if(!l||0===c.length)return void console.warn("Missing slider elements in block",i);if("true"===i.dataset.initialized)return;let n=i.querySelector(".slider-control"),t=(n?n.innerHTML="":((n=document.createElement("div")).classList.add("slider-control"),i.prepend(n)),0),o=0,a=0,r=!1,e;const d=o=>{o>=c.length?o=0:o<0&&(o=c.length-1);var e=c[0].offsetWidth;"undefined"!=typeof gsap?gsap.to(l,{x:-o*e,duration:.6,ease:"power2.out"}):l.style.transform=`translateX(-${o*e}px)`,i.querySelectorAll(".slider-button").forEach((e,t)=>{e.classList.toggle("active",t===o)}),t=o},u=()=>{p(),e=setInterval(()=>{d(t+1)},3500)},p=()=>{e&&(clearInterval(e),e=null)};c.forEach((e,t)=>{var o=document.createElement("button");o.classList.add("slider-button"),o.textContent=t+1,o.addEventListener("click",()=>{d(t),u()}),n.appendChild(o)});var s=n.querySelector(".slider-button");s&&s.classList.add("active"),l.addEventListener("touchstart",e=>{o=e.touches[0].clientX,r=!0,p()}),l.addEventListener("touchmove",e=>{r&&(a=e.touches[0].clientX)}),l.addEventListener("touchend",()=>{var e;r&&(e=o-a,50<Math.abs(e)&&(0<e&&t<c.length-1?d(t+1):e<0&&0<t&&d(t-1)),r=!1,u())}),i.addEventListener("mouseenter",p),i.addEventListener("mouseleave",u),window.addEventListener("resize",()=>{d(t)}),u(),i.dataset.initialized="true"}catch(e){console.error("Error in slider block processing:",e)}})}function initTypecardTabs(n,a){n.forEach(e=>{"true"!==e.dataset.handlerAttached&&(e.addEventListener("click",function(){try{n.forEach(e=>e.classList.remove("typecard__tab_active")),this.classList.add("typecard__tab_active");var e=this.getAttribute("data-tab");if(e){const t=document.querySelector(".typecard__content_active"),o=document.getElementById(e+"-content");o&&t&&("undefined"!=typeof gsap?gsap.to(t,{opacity:0,duration:.3,onComplete:function(){t.classList.remove("typecard__content_active"),o.classList.add("typecard__content_active"),o.style.opacity=0,gsap.to(o,{opacity:1,duration:.3})}}):"undefined"!=typeof jQuery?jQuery(".typecard__content_active").fadeOut(300,function(){jQuery(this).removeClass("typecard__content_active"),jQuery(o).css("display","none").addClass("typecard__content_active").fadeIn(300)}):(a.forEach(e=>e.classList.remove("typecard__content_active")),o.classList.add("typecard__content_active")))}}catch(e){console.error("Error in tab click handling:",e)}}),e.dataset.handlerAttached="true")})}function initHomePage(){try{var e=document.querySelectorAll(".slider-block"),t=(0<e.length&&initSliderBlocks(e),document.querySelectorAll(".typecard__tab")),o=document.querySelectorAll(".typecard__content");0<t.length&&0<o.length&&initTypecardTabs(t,o)}catch(e){console.error("Error in initHomePage:",e)}}function initAnimNumbers(){var e=document.querySelectorAll(".anime-number");0!==e.length&&"undefined"!=typeof gsap&&e.forEach(o=>{var e=o.textContent.match(/^(.*?)(\d[\d,.]+)(.*)$/);if(e){const n=e[1]||"",a=e[2],r=e[3]||"";e=parseFloat(a.replace(/,/g,""));const i=a.includes("."),s=i?a.split(".")[1].length:0,l={value:0};gsap.to(l,{value:e,duration:2,ease:"power1.out",onUpdate:function(){let e;var t;e=i?l.value.toFixed(s):Math.floor(l.value),a.includes(",")&&((t=e.toString().split("."))[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),e=t.join(".")),o.textContent=n+e+r}})}})}function initSwiperSlider(){try{"undefined"==typeof Swiper?console.warn("Swiper не найден"):(document.querySelector(".typecard__slide")&&new Swiper(".typecard__slide",{slidesPerView:1,loop:!0,speed:800,navigation:{nextEl:".btn-next",prevEl:".btn-prev"},autoplay:{delay:2500,disableOnInteraction:!0}}),document.querySelector(".blog-slider")&&new Swiper(".blog-slider",{slidesPerView:1.1,loop:!0,spaceBetween:20,navigation:{nextEl:".btn-next",prevEl:".btn-prev"},breakpoints:{560:{slidesPerView:1.5},991:{slidesPerView:2},1200:{slidesPerView:3}},autoplay:{delay:2500,disableOnInteraction:!0}}),initVideoCarousel())}catch(e){console.error("Error in initSwiperSlider:",e)}}function initVideoCarousel(){try{var e;"undefined"==typeof jQuery?console.warn("jQuery не найден, Slick карусель недоступна"):0===(e=jQuery(".reviews__slider")).length||e.hasClass("slick-initialized")||(e.slick({dots:!0,infinite:!1,slidesToShow:1,slidesToScroll:1,centerMode:!0,centerPadding:"0px",speed:500,variableWidth:!0,cssEase:"ease-in-out",lazyLoad:"ondemand",responsive:[{breakpoint:1200,settings:{slidesToShow:2,slidesToScroll:1}}]}),console.log("Video carousel initialized successfully"))}catch(e){console.error("Error in initVideoCarousel:",e)}}function initZohoForms(){const a=(e,t)=>{e=document.getElementById(e);if(e&&t&&!e.querySelector("iframe")){const a=[];["utm_source","utm_medium","utm_campaign","utm_term","utm_content"].forEach(e=>{var t=(e=>{var o=e+"=",n=document.cookie.split(";");for(let t=0;t<n.length;t++){let e=n[t];for(;" "==e.charAt(0);)e=e.substring(1,e.length);if(0==e.indexOf(o))return e.substring(o.length,e.length)}return null})(e);t&&a.push(e+"="+encodeURIComponent(t))});var o=a.join("&"),n=document.createElement("iframe");n.src="https://forms.zohopublic.com/tsstechnology/form/TSST/formperma/"+t+"?zf_rszfm=1"+(o?"&"+o:""),n.style.border="none",n.style.height="800px",n.style.width="100%",n.setAttribute("aria-label","TSST Form"),e.appendChild(n)}};window.zohoResizeListenerAttached||(window.addEventListener("message",function(e){try{if(e.data&&"string"==typeof e.data){var t=e.data.split("|");if(2<=t.length){var o=t[0],n=parseInt(t[1],10)+15+"px",a=document.getElementsByTagName("iframe");for(let e=0;e<a.length;e++)if(a[e].src.includes(o)){a[e].style.height!==n&&(a[e].style.height=n);break}}}}catch(e){}},!1),window.zohoResizeListenerAttached=!0),document.querySelectorAll("[data-zoho-trigger-for]").forEach(e=>{if(!e.dataset.zohoListener){const o=e.dataset.zohoTriggerFor;var t=document.getElementById(o);if(t){const n=t.dataset.zohoForm;n&&(e.addEventListener("click",()=>{a(o,n)}),e.dataset.zohoListener="true")}}}),document.querySelectorAll("[data-zoho-form]").forEach(e=>{if(e.id&&document.querySelector(`[data-zoho-trigger-for="${e.id}"]`))return;var t=e.dataset.zohoForm;e.id||(e.id="zoho-auto-id-"+Math.random().toString(36).substr(2,9)),a(e.id,t)})}function initCalc(){try{const r=document.getElementById("fleet-slider"),i=document.getElementById("fleet-value"),s=document.getElementById("fleet-tooltip"),l=document.getElementById("gallons-slider"),c=document.getElementById("gallons-value"),d=document.getElementById("gallons-tooltip"),u=document.getElementById("savings-amount"),p=document.getElementById("savings-amount-sm"),m=document.querySelectorAll(".button-group__button");if(r&&l&&u){let o=1,n=1,a=50;function t(){var e=.5*a*o*n,e=Number.isInteger(e)?e:e.toFixed(1);if("undefined"!=typeof gsap){const t={value:parseFloat(u.textContent)||0};gsap.to(t,{value:parseFloat(e),duration:.5,ease:"power1.out",onUpdate:function(){var e=Number.isInteger(t.value)?Math.floor(t.value):t.value.toFixed(1);u.textContent=""+e,p&&(p.textContent=""+e)}})}else u.textContent=""+e,p&&(p.textContent=""+e)}function e(e,t){var o,n;e&&t&&(o=parseInt(e.min),n=parseInt(e.max),n=(parseInt(e.value)-o)/(n-o)*100/100*(e.offsetWidth-60)+30,"undefined"!=typeof gsap?gsap.to(t,{left:n+"px",duration:.2,ease:"power1.out"}):t.style.left=n+"px")}r&&i&&s&&r.addEventListener("input",function(){o=parseInt(this.value),i.textContent=o,s.textContent=o,e(r,s),t()}),l&&c&&d&&l.addEventListener("input",function(){a=parseInt(this.value),c.textContent=a,d.textContent=a,e(l,d),t()}),0<m.length&&m.forEach(e=>{e.addEventListener("click",function(){m.forEach(e=>e.classList.remove("button-group__button--active")),this.classList.add("button-group__button--active"),n=parseInt(this.dataset.value)||1,t()})}),window.addEventListener("load",function(){e(r,s),e(l,d)}),t()}}catch(e){console.error("Error in initCalc:",e)}}function initMultiStepForm(){document.addEventListener("wpcf7mailsent",function(e){e.target.classList.contains("form-redirect")&&barba.go("https://ias.rsq.mybluehost.me/website_e4331c8e/card-activation-thank-you/")},!1);const r=document.querySelector(".form")||document.querySelector(".wpcf7-form");if(r){const d=Array.from(r.querySelectorAll(".form__step, .form-step"));if(!(d.length<2)){var e=r.querySelectorAll(".form__step-next, .next-step"),t=r.querySelectorAll(".form__step-back");const n=document.querySelectorAll(".form__step-header ul li, .progress-steps li"),u=new Map,a=(n.forEach(e=>{var t=e.textContent.trim();/^\d+$/.test(t)&&0<=(t=parseInt(t)-1)&&t<d.length&&u.set(d[t],e)}),d.forEach((e,t)=>{0===t?(gsap.set(e,{autoAlpha:1}),e.style.display="block",(t=u.get(e))&&t.classList.add("filled")):gsap.set(e,{autoAlpha:0,display:"none"})}),e.forEach((a,e)=>{a.addEventListener("click",function(e){e.preventDefault();let o=null,n=-1;var t;d.forEach((e,t)=>{e.contains(a)&&(o=e,n=t)}),o&&n<d.length-1&&(e=d[n+1],s(i(o)))&&((t=u.get(e))&&t.classList.add("filled"),gsap.timeline().to(o,{autoAlpha:0,duration:.4,ease:"power2.out"}).set(o,{display:"none"}).set(e,{display:"block"}).to(e,{autoAlpha:1,duration:.4,ease:"power2.in"}))})}),t.forEach(a=>{a.addEventListener("click",function(e){e.preventDefault();let o=null,n=-1;var t;d.forEach((e,t)=>{e.contains(a)&&(o=e,n=t)}),o&&0<n&&(e=d[n-1],(t=u.get(o))&&t.classList.remove("filled"),gsap.timeline().to(o,{autoAlpha:0,duration:.4,ease:"power2.out"}).set(o,{display:"none"}).set(e,{display:"block"}).to(e,{autoAlpha:1,duration:.4,ease:"power2.in"}))})}),r.querySelector('input[type="submit"], button[type="submit"]'));function i(e){const t=[];return e.querySelectorAll('input[aria-required="true"], select[aria-required="true"], textarea[aria-required="true"]').forEach(e=>t.push(e)),e.querySelectorAll("input[required], select[required], textarea[required]").forEach(e=>{t.includes(e)||t.push(e)}),e.querySelectorAll("input.wpcf7-validates-as-required, select.wpcf7-validates-as-required, textarea.wpcf7-validates-as-required").forEach(e=>{t.includes(e)||t.push(e)}),t}function s(e){let a=!0;return r.querySelectorAll(".form-error-message").forEach(e=>e.remove()),r.querySelectorAll(".input-error").forEach(e=>{e.classList.remove("input-error")}),e.forEach(e=>{var t,o,n=e.closest("span")||e.parentNode;"SELECT"===e.tagName?l(e)&&(o=0<e.selectedIndex,t=e.value&&""!==e.value&&!e.value.includes("Select"),o&&t||(a=!1,c(e,n,"Please select an option"))):"checkbox"===e.type||"radio"===e.type?l(e)&&!e.checked&&(a=!1,c(e,n,"This field is required")):l(e)&&(e.value.trim()||(a=!1,c(e,n,"This field is required")),"email"===e.type&&e.value.trim()&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.value.trim())&&(a=!1,c(e,n,"Please enter a valid email address")),("tel"===e.type||e.name.includes("phone")||e.name.includes("tel"))&&e.value.trim()&&!/^[0-9\+\-\(\)\s]+$/.test(e.value.trim())&&(a=!1,c(e,n,"Please enter a valid phone number")),e.name.includes("confirm_email"))&&e.value.trim()&&(o=r.querySelector('input[name="email"], input[name*="email"]:not([name*="confirm"])'))&&e.value!==o.value&&(a=!1,c(e,n,"Email addresses do not match"))}),a}function l(e){return e.hasAttribute("required")||"true"===e.getAttribute("aria-required")||e.classList.contains("wpcf7-validates-as-required")}function c(e,t,o){e.classList.add("input-error");var n=document.createElement("span");n.className="form-error-message",n.textContent=o,n.style.opacity="0",t.appendChild(n),gsap.to(n,{opacity:1,duration:.3,ease:"power2.out"}),gsap.fromTo(e,{x:0},{x:5,duration:.1,repeat:3,yoyo:!0})}function o(){n.forEach((e,t)=>{0<t&&e.classList.remove("filled")});var e=d.find(e=>"none"!==getComputedStyle(e).display);e&&e!==d[0]&&(gsap.timeline().to(e,{autoAlpha:0,duration:.4,ease:"power2.out"}).set(e,{display:"none"}).set(d[0],{display:"block"}).to(d[0],{autoAlpha:1,duration:.4,ease:"power2.in"}),gsap.delayedCall(.5,function(){r.querySelectorAll('input[type="text"], input[type="email"], input[type="tel"], input[type="number"], textarea, select').forEach(e=>{"checkbox"===e.type||"radio"===e.type?e.checked=!1:e.value="","SELECT"===e.tagName&&(e.selectedIndex=0)})}))}a&&a.addEventListener("click",function(e){r.classList.contains("wpcf7-form")||e.preventDefault();e=d.find(e=>e.contains(a));e&&s(i(e))&&!r.classList.contains("wpcf7-form")&&(alert("Form submitted successfully!"),o())}),"function"==typeof document.addEventListener&&(document.addEventListener("wpcf7invalid",function(e){}),document.addEventListener("wpcf7mailsent",function(){o()})),document.getElementById("multi-step-form-styles")||((e=document.createElement("style")).id="multi-step-form-styles",e.textContent=`
            .input-error {
                border-color: red !important;
            }
            .form-error-message {
                color: red;
                font-size: 12px;
                display: block;
                margin-top: 5px;
            }
        `,document.head.appendChild(e))}}}function initLoginPage(){const t=document.getElementById("login-form-container"),o=document.getElementById("recovery-form-container");var e=document.getElementById("show-recovery"),n=document.getElementById("show-login"),a=document.getElementById("show-contact");const r=document.getElementById("contact-popup");var i=document.querySelector(".close-popup");o&&gsap.set(o,{autoAlpha:0,display:"none"}),r&&gsap.set(r,{autoAlpha:0,display:"none"}),e&&n&&t&&o&&(e.addEventListener("click",function(e){e.preventDefault(),gsap.to(t,{autoAlpha:0,y:-20,duration:.3,ease:"power2.out",onComplete:function(){gsap.set(t,{display:"none"}),gsap.set(o,{display:"block",y:20}),gsap.to(o,{autoAlpha:1,y:0,duration:.3,ease:"power2.out"})}})}),n.addEventListener("click",function(e){e.preventDefault(),gsap.to(o,{autoAlpha:0,y:-20,duration:.3,ease:"power2.out",onComplete:function(){gsap.set(o,{display:"none"}),gsap.set(t,{display:"block",y:20}),gsap.to(t,{autoAlpha:1,y:0,duration:.3,ease:"power2.out"})}})})),a&&r&&i&&(a.addEventListener("click",function(e){e.preventDefault(),gsap.set(r,{display:"flex"}),gsap.fromTo(r,{autoAlpha:0,scale:.9},{autoAlpha:1,scale:1,duration:.3,ease:"power2.out"})}),i.addEventListener("click",function(){gsap.to(r,{autoAlpha:0,scale:.9,duration:.3,ease:"power2.in",onComplete:function(){gsap.set(r,{display:"none"})}})}),r.addEventListener("click",function(e){e.target===r&&gsap.to(r,{autoAlpha:0,scale:.9,duration:.3,ease:"power2.in",onComplete:function(){gsap.set(r,{display:"none"})}})}));const s=document.getElementById("login-form"),l=(s&&s.addEventListener("submit",function(e){var t=document.getElementById("user_login"),o=document.getElementById("user_pass");t.value&&o.value||(e.preventDefault(),gsap.to(s,{x:[-10,10,-8,8,-5,5,0],duration:.5,ease:"power2.out"}),alert("Пожалуйста, заполните все поля"))}),document.getElementById("recovery-form")),c=(l&&l.addEventListener("submit",function(e){document.getElementById("user_email").value||(e.preventDefault(),gsap.to(l,{x:[-10,10,-8,8,-5,5,0],duration:.5,ease:"power2.out"}),alert("Пожалуйста, введите email или логин"))}),document.getElementById("contact-form"));c&&c.addEventListener("submit",function(e){e.preventDefault(),alert("Ваше сообщение отправлено. Мы свяжемся с вами в ближайшее время."),gsap.to(r,{autoAlpha:0,scale:.9,duration:.3,ease:"power2.in",onComplete:function(){gsap.set(r,{display:"none"}),c.reset()}})});e=new URLSearchParams(window.location.search);e.has("login")&&"failed"===e.get("login")&&alert("Неверный логин или пароль. Пожалуйста, попробуйте снова.")}function togglePasswordVisibility(){var e=document.getElementById("user_pass"),t=document.querySelector(".toggle-password");e&&t&&("password"===e.type?(e.type="text",t.classList.add("visible")):(e.type="password",t.classList.remove("visible")))}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",initMultiStepForm):initMultiStepForm();